import mmm_api as mmm
import json

midi_json={'tracks': [{'bars': [{'events': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 'internalBeatLength': 4, 'tsNumerator': 4, 'tsDenominator': 4}, {'events': [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55], 'internalBeatLength': 4, 'tsNumerator': 4, 'tsDenominator': 4}, {'events': [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83], 'internalBeatLength': 4, 'tsNumerator': 4, 'tsDenominator': 4}, {'events': [84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111], 'internalBeatLength': 4, 'tsNumerator': 4, 'tsDenominator': 4}], 'instrument': 0, 'trackType': 10, 'internalFeatures': [{'avPolyphony': 1.21428573, 'noteDensityV2': 8, 'noteDuration': 4, 'minPolyphonyQ': 0, 'maxPolyphonyQ': 1, 'minNoteDurationQ': 0, 'maxNoteDurationQ': 0, 'polyphonyDistribution': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1], 'noteDensityValue': 14}]}], 'events': [{'time': 1, 'velocity': 108, 'pitch': 70}, {'time': 2, 'velocity': 0, 'pitch': 65}, {'time': 2, 'velocity': 0, 'pitch': 70}, {'time': 2, 'velocity': 108, 'pitch': 65}, {'time': 4, 'velocity': 108, 'pitch': 70}, {'time': 5, 'velocity': 0, 'pitch': 70}, {'time': 6, 'velocity': 108, 'pitch': 71}, {'time': 7, 'velocity': 0, 'pitch': 71}, {'time': 8, 'velocity': 108, 'pitch': 71}, {'time': 9, 'velocity': 0, 'pitch': 71}, {'time': 10, 'velocity': 108, 'pitch': 67}, {'time': 11, 'velocity': 0, 'pitch': 67}, {'time': 14, 'velocity': 108, 'pitch': 67}, {'time': 15, 'velocity': 0, 'pitch': 67}, {'time': 17, 'velocity': 0, 'pitch': 69}, {'time': 17, 'velocity': 108, 'pitch': 69}, {'time': 21, 'velocity': 108, 'pitch': 66}, {'time': 22, 'velocity': 0, 'pitch': 66}, {'time': 26, 'velocity': 108, 'pitch': 65}, {'time': 27, 'velocity': 0, 'pitch': 65}, {'time': 29, 'velocity': 0, 'pitch': 71}, {'time': 29, 'velocity': 108, 'pitch': 71}, {'time': 30, 'velocity': 108, 'pitch': 67}, {'time': 31, 'velocity': 0, 'pitch': 67}, {'time': 36, 'velocity': 108, 'pitch': 70}, {'time': 37, 'velocity': 0, 'pitch': 70}, {'time': 39, 'velocity': 108, 'pitch': 65}, {'time': 40, 'velocity': 0, 'pitch': 65}, {'time': 1, 'velocity': 108, 'pitch': 70}, {'time': 2, 'velocity': 0, 'pitch': 65}, {'time': 2, 'velocity': 0, 'pitch': 70}, {'time': 2, 'velocity': 108, 'pitch': 65}, {'time': 4, 'velocity': 108, 'pitch': 70}, {'time': 5, 'velocity': 0, 'pitch': 70}, {'time': 6, 'velocity': 108, 'pitch': 71}, {'time': 7, 'velocity': 0, 'pitch': 71}, {'time': 8, 'velocity': 108, 'pitch': 71}, {'time': 9, 'velocity': 0, 'pitch': 71}, {'time': 10, 'velocity': 108, 'pitch': 67}, {'time': 11, 'velocity': 0, 'pitch': 67}, {'time': 14, 'velocity': 108, 'pitch': 67}, {'time': 15, 'velocity': 0, 'pitch': 67}, {'time': 17, 'velocity': 0, 'pitch': 69}, {'time': 17, 'velocity': 108, 'pitch': 69}, {'time': 21, 'velocity': 108, 'pitch': 66}, {'time': 22, 'velocity': 0, 'pitch': 66}, {'time': 26, 'velocity': 108, 'pitch': 65}, {'time': 27, 'velocity': 0, 'pitch': 65}, {'time': 29, 'velocity': 0, 'pitch': 71}, {'time': 29, 'velocity': 108, 'pitch': 71}, {'time': 30, 'velocity': 108, 'pitch': 67}, {'time': 31, 'velocity': 0, 'pitch': 67}, {'time': 36, 'velocity': 108, 'pitch': 70}, {'time': 37, 'velocity': 0, 'pitch': 70}, {'time': 39, 'velocity': 108, 'pitch': 65}, {'time': 40, 'velocity': 0, 'pitch': 65}, {'time': 1, 'velocity': 108, 'pitch': 70}, {'time': 2, 'velocity': 0, 'pitch': 65}, {'time': 2, 'velocity': 0, 'pitch': 70}, {'time': 2, 'velocity': 108, 'pitch': 65}, {'time': 4, 'velocity': 108, 'pitch': 70}, {'time': 5, 'velocity': 0, 'pitch': 70}, {'time': 6, 'velocity': 108, 'pitch': 71}, {'time': 7, 'velocity': 0, 'pitch': 71}, {'time': 8, 'velocity': 108, 'pitch': 71}, {'time': 9, 'velocity': 0, 'pitch': 71}, {'time': 10, 'velocity': 108, 'pitch': 67}, {'time': 11, 'velocity': 0, 'pitch': 67}, {'time': 14, 'velocity': 108, 'pitch': 67}, {'time': 15, 'velocity': 0, 'pitch': 67}, {'time': 17, 'velocity': 0, 'pitch': 69}, {'time': 17, 'velocity': 108, 'pitch': 69}, {'time': 21, 'velocity': 108, 'pitch': 66}, {'time': 22, 'velocity': 0, 'pitch': 66}, {'time': 26, 'velocity': 108, 'pitch': 65}, {'time': 27, 'velocity': 0, 'pitch': 65}, {'time': 29, 'velocity': 0, 'pitch': 71}, {'time': 29, 'velocity': 108, 'pitch': 71}, {'time': 30, 'velocity': 108, 'pitch': 67}, {'time': 31, 'velocity': 0, 'pitch': 67}, {'time': 36, 'velocity': 108, 'pitch': 70}, {'time': 37, 'velocity': 0, 'pitch': 70}, {'time': 39, 'velocity': 108, 'pitch': 65}, {'time': 40, 'velocity': 0, 'pitch': 65}, {'time': 1, 'velocity': 108, 'pitch': 70}, {'time': 2, 'velocity': 0, 'pitch': 65}, {'time': 2, 'velocity': 0, 'pitch': 70}, {'time': 2, 'velocity': 108, 'pitch': 65}, {'time': 4, 'velocity': 108, 'pitch': 70}, {'time': 5, 'velocity': 0, 'pitch': 70}, {'time': 6, 'velocity': 108, 'pitch': 71}, {'time': 7, 'velocity': 0, 'pitch': 71}, {'time': 8, 'velocity': 108, 'pitch': 71}, {'time': 9, 'velocity': 0, 'pitch': 71}, {'time': 10, 'velocity': 108, 'pitch': 67}, {'time': 11, 'velocity': 0, 'pitch': 67}, {'time': 14, 'velocity': 108, 'pitch': 67}, {'time': 15, 'velocity': 0, 'pitch': 67}, {'time': 17, 'velocity': 0, 'pitch': 69}, {'time': 17, 'velocity': 108, 'pitch': 69}, {'time': 21, 'velocity': 108, 'pitch': 66}, {'time': 22, 'velocity': 0, 'pitch': 66}, {'time': 26, 'velocity': 108, 'pitch': 65}, {'time': 27, 'velocity': 0, 'pitch': 65}, {'time': 29, 'velocity': 0, 'pitch': 71}, {'time': 29, 'velocity': 108, 'pitch': 71}, {'time': 30, 'velocity': 108, 'pitch': 67}, {'time': 31, 'velocity': 0, 'pitch': 67}, {'time': 36, 'velocity': 108, 'pitch': 70}, {'time': 37, 'velocity': 0, 'pitch': 70}, {'time': 39, 'velocity': 108, 'pitch': 65}, {'time': 40, 'velocity': 0, 'pitch': 65}], 'resolution': 12, 'tempo': 120}
valid_status={'tracks': [{'track_id': 0, 'instrument': 'acoustic_grand_piano', 'density': 0, 'track_type': 10, 'ignore': False, 'selected_bars': [False, True, False, False], 'min_polyphony_q': 'POLYPHONY_ONE', 'max_polyphony_q': 'POLYPHONY_TWO', 'min_note_duration_q': 'DURATION_THIRTY_SECOND', 'max_note_duration_q': 'DURATION_THIRTY_SECOND', 'autoregressive': False}]}
param={'tracks_per_step': 1, 'bars_per_step': 2, 'model_dim': 4, 'percentage': 100, 'batch_size': 1, 'temperature': 1, 'max_steps': 0, 'polyphony_hard_limit': 6, 'shuffle': True, 'verbose': False, 'ckpt': 'model.pt'}

piece = json.dumps(midi_json)
status = json.dumps(valid_status)
param = json.dumps(param)

midi_str = mmm.sample_multi_step(piece, status, param)
